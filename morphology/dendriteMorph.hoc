
proc celldef() {
  topol()
  subsets()
  geom_nseg()
}

create dend[32]

proc topol() { local i
  for i = 1, 2 connect dend[i](0), dend(0.5)
  for i = 3, 7 connect dend[i](0), dend[i-1](1)
  connect dend[8](0), dend[5](1)
  connect dend[9](0), dend[3](1)
  for i = 10, 11 connect dend[i](0), dend[i-1](1)
  connect dend[12](0), dend[4](1)
  connect dend[13](0), dend[6](1)
  connect dend[14](0), dend[2](1)
  for i = 15, 16 connect dend[i](0), dend[i-1](1)
  connect dend[17](0), dend[10](1)
  for i = 18, 19 connect dend[i](0), dend[17](1)
  connect dend[20](0), dend[9](1)
  connect dend[21](0), dend[20](1)
  connect dend[22](0), dend[15](1)
  connect dend[23](0), dend[22](1)
  connect dend[24](0), dend[14](1)
  connect dend[25](0), dend[24](1)
  connect dend[26](0), dend[17](1)
  connect dend[27](0), dend[20](1)
  connect dend[28](0), dend[22](1)
  connect dend[29](0), dend[24](1)
  for i = 30, 31 connect dend[i](0), dend[29](1)
  basic_shape()
}
proc shape3d_1() {
  dend {pt3dclear()
	pt3dadd(15.77, 16.47, 23.76, 2.098)
	pt3dadd(15.741, 16.204, 23.82, 2.2748)
	pt3dadd(15.96, 16.2, 23.996, 2.233)
  }
  dend[1] {pt3dclear()
	pt3dstyle(1, 15.96, 16.2, 23.996)
	pt3dadd(16.092, 16.068, 23.996, 2.1912)
	pt3dadd(16.025, 15.737, 23.997, 2.1496)
  }
  dend[2] {pt3dclear()
	pt3dstyle(1, 15.96, 16.2, 23.996)
	pt3dadd(16.024, 16.267, 23.558, 1.75372)
	pt3dadd(15.84, 16.192, 23.39, 1.2653)
	pt3dadd(15.544, 15.863, 23.688, 1.56706)
	pt3dadd(15.682, 15.722, 24.033, 1.66198)
	pt3dadd(15.593, 15.608, 24.322, 1.7545)
	pt3dadd(15.411, 15.473, 24.636, 1.6168)
	pt3dadd(15.182, 15.595, 24.787, 1.35368)
	pt3dadd(15.366, 15.408, 24.796, 1.45898)
	pt3dadd(15.3, 15.276, 24.796, 1.5643)
	pt3dadd(15.569, 15.629, 24.775, 1.6696)
	pt3dadd(15.502, 15.571, 25.242, 1.61812)
	pt3dadd(15.539, 15.419, 25.64, 1.60086)
	pt3dadd(15.496, 15.272, 26.055, 1.30968)
	pt3dadd(15.566, 15.205, 26.464, 1.73292)
	pt3dadd(15.834, 15.101, 26.821, 1.5191)
	pt3dadd(15.856, 15.328, 27.221, 1.7367)
	pt3dadd(15.941, 15.298, 27.598, 1.68136)
	pt3dadd(16.173, 15.149, 27.968, 1.53302)
	pt3dadd(16.077, 15.32, 28.399, 1.66974)
	pt3dadd(16.162, 15.398, 28.776, 1.66932)
	pt3dadd(16.177, 15.618, 29.21, 1.54414)
	pt3dadd(16.158, 15.751, 29.608, 1.60694)
	pt3dadd(16.192, 15.794, 30.014, 1.55126)
	pt3dadd(16.141, 15.91, 30.398, 1.52656)
	pt3dadd(16.09, 15.918, 30.816, 1.46394)
	pt3dadd(16.123, 16.268, 31.163, 1.00786)
	pt3dadd(16.135, 16.26, 31.581, 1.40964)
	pt3dadd(15.998, 16.203, 31.986, 1.51378)
	pt3dadd(16.111, 16.291, 32.386, 1.40816)
	pt3dadd(16.026, 16.311, 32.79, 1.47366)
	pt3dadd(16.041, 16.348, 33.195, 1.57452)
	pt3dadd(16.163, 16.669, 33.594, 1.48322)
	pt3dadd(15.954, 16.455, 33.974, 1.6143)
	pt3dadd(15.924, 16.494, 34.378, 1.58338)
	pt3dadd(15.9, 16.588, 34.78, 1.61918)
	pt3dadd(15.831, 16.555, 35.194, 1.63456)
	pt3dadd(15.729, 16.672, 35.574, 1.61094)
	pt3dadd(15.629, 16.8, 35.945, 1.54164)
	pt3dadd(15.637, 16.856, 36.071, 1.5376)
	pt3dadd(15.62, 16.912, 36.46, 1.5548)
	pt3dadd(15.517, 17.064, 36.809, 1.44436)
	pt3dadd(15.409, 17.121, 37.218, 1.35606)
	pt3dadd(15.483, 17.281, 37.61, 1.34808)
	pt3dadd(15.438, 17.429, 37.977, 1.32854)
	pt3dadd(15.509, 17.526, 38.365, 1.35954)
	pt3dadd(15.532, 17.546, 38.43, 1.36124)
	pt3dadd(15.558, 17.697, 38.821, 1.38196)
	pt3dadd(15.549, 17.758, 39.219, 1.32516)
	pt3dadd(15.467, 17.975, 39.581, 1.32724)
	pt3dadd(15.533, 18.105, 39.965, 1.28032)
	pt3dadd(15.478, 18.203, 40.35, 1.3406)
	pt3dadd(15.384, 18.256, 40.75, 1.3881)
	pt3dadd(15.317, 18.384, 40.8, 1.35724)
	pt3dadd(15.273, 18.421, 41.228, 1.3367)
	pt3dadd(15.112, 18.553, 41.568, 1.14216)
	pt3dadd(14.942, 18.605, 41.968, 1.24)
	pt3dadd(14.724, 18.65, 42.295, 1.23456)
	pt3dadd(14.648, 18.68, 42.425, 1.22692)
	pt3dadd(14.619, 18.663, 42.485, 1.1143)
	pt3dadd(14.506, 18.772, 42.87, 1.24918)
	pt3dadd(14.384, 18.881, 43.209, 1.28552)
	pt3dadd(14.103, 19.009, 43.554, 1.16232)
	pt3dadd(14.026, 19.112, 43.944, 1.1464)
	pt3dadd(13.993, 19.126, 44.109, 1.25462)
	pt3dadd(13.9, 19.333, 44.434, 1.1818)
	pt3dadd(13.744, 19.617, 44.798, 1.07342)
	pt3dadd(13.679, 19.776, 45.181, 1.13156)
	pt3dadd(13.576, 19.97, 45.54, 1.17766)
	pt3dadd(13.496, 20.152, 45.906, 1.21188)
	pt3dadd(13.367, 20.3, 46.315, 1.19488)
	pt3dadd(13.321, 20.417, 46.748, 1.19932)
	pt3dadd(13.184, 20.497, 47.151, 1.24306)
	pt3dadd(13.131, 20.489, 47.214, 1.2888)
	pt3dadd(12.996, 20.537, 47.609, 1.41002)
	pt3dadd(12.732, 20.588, 47.937, 1.46538)
	pt3dadd(12.092, 20.483, 48.171, 2.0542)
	pt3dadd(12.127, 20.625, 48.557, 2.3244)
	pt3dadd(11.924, 20.624, 48.924, 2.2408)
	pt3dadd(11.812, 20.552, 49.027, 2.3334)
	pt3dadd(11.699, 20.708, 49.921, 2.5734)
	pt3dadd(11.443, 20.599, 50.352, 2.5836)
	pt3dadd(11.332, 20.619, 50.389, 2.614)
	pt3dadd(11.109, 21.044, 50.467, 2.7018)
	pt3dadd(10.556, 21.034, 50.787, 2.6852)
	pt3dadd(10.495, 21.218, 51.199, 2.6684)
	pt3dadd(11.768, 21.7, 52.828, 5.28)
	pt3dadd(11.621, 22.053, 53.185, 5.28)
	pt3dadd(9.558, 22.008, 52.796, 7.2)
	pt3dadd(10.03, 20.531, 53.934, 7.2)
	pt3dadd(9.636, 20.754, 54.392, 7.2)
	pt3dadd(8.892, 20.564, 54.362, 7.2)
	pt3dadd(8.72, 20.641, 54.799, 7.2)
	pt3dadd(8.618, 20.671, 55.302, 7.2)
	pt3dadd(8.097, 22.794, 55.563, 7.2)
	pt3dadd(7.962, 22.846, 55.628, 7.2)
	pt3dadd(7.719, 23.057, 55.983, 7.2)
	pt3dadd(7.678, 23.129, 56.431, 7.2)
	pt3dadd(7.347, 23.304, 56.766, 7.2)
	pt3dadd(7.167, 23.366, 57.18, 7.2)
	pt3dadd(6.645, 23.701, 57.476, 7.2)
	pt3dadd(7.017, 23.891, 57.976, 2.7314)
  }
  dend[3] {pt3dclear()
	pt3dadd(7.017, 23.891, 57.976, 2.7314)
	pt3dadd(6.726, 23.998, 58.779, 2.5988)
	pt3dadd(6.585, 24.192, 59.133, 2.6792)
	pt3dadd(6.63, 24.129, 59.589, 2.5974)
	pt3dadd(6.597, 24.242, 59.992, 2.6254)
	pt3dadd(6.293, 24.317, 60.413, 2.5532)
	pt3dadd(5.876, 24.424, 61.038, 1.99036)
	pt3dadd(6.06, 24.714, 61.596, 1.9401)
  }
  dend[4] {pt3dclear()
	pt3dadd(6.06, 24.714, 61.596, 1.9401)
	pt3dadd(5.615, 24.619, 61.597, 1.88986)
	pt3dadd(5.524, 25.106, 61.932, 1.61646)
	pt3dadd(5.399, 25.514, 62.329, 1.1672)
	pt3dadd(5.267, 26.079, 62.298, 0.91526)
	pt3dadd(5.187, 26.322, 62.154, 0.8887)
	pt3dadd(5.107, 26.452, 62.156, 0.8365)
	pt3dadd(5.002, 26.759, 62.163, 0.68364)
	pt3dadd(4.906, 26.961, 62.198, 0.61134)
	pt3dadd(4.96, 27.108, 62.483, 0.6986)
	pt3dadd(4.879, 27.421, 62.305, 0.569)
	pt3dadd(4.885, 27.58, 62.059, 0.4913)
	pt3dadd(4.811, 27.811, 62.147, 0.60078)
	pt3dadd(4.789, 27.941, 62.081, 0.396)
	pt3dadd(4.773, 28.131, 62.01, 0.53104)
	pt3dadd(4.764, 28.188, 61.864, 0.4933)
	pt3dadd(4.745, 28.228, 61.679, 0.61404)
	pt3dadd(4.727, 28.295, 61.616, 0.55616)
	pt3dadd(4.702, 28.382, 61.579, 0.55624)
	pt3dadd(4.693, 28.459, 61.714, 0.6062)
	pt3dadd(4.639, 28.54, 61.913, 0.55866)
	pt3dadd(4.601, 28.593, 62.025, 0.55684)
	pt3dadd(4.503, 28.822, 61.931, 0.55742)
  }
  dend[5] {pt3dclear()
	pt3dadd(4.503, 28.822, 61.931, 0.55742)
	pt3dadd(4.372, 29.06, 61.774, 1.02858)
	pt3dadd(4.327, 29.228, 61.87, 0.77682)
	pt3dadd(4.312, 29.374, 61.927, 0.84448)
	pt3dadd(4.291, 29.441, 61.964, 0.88874)
  }
  dend[6] {pt3dclear()
	pt3dadd(4.291, 29.441, 61.964, 0.88874)
	pt3dadd(4.079, 29.562, 62.669, 1.20032)
	pt3dadd(4.089, 29.621, 62.676, 1.16198)
	pt3dadd(4.394, 29.906, 62.378, 0.9666)
  }
  dend[7] {pt3dclear()
	pt3dadd(4.394, 29.906, 62.378, 0.9666)
	pt3dadd(4.345, 30.004, 62.098, 0.66)
	pt3dadd(4.496, 30.348, 62.4, 0.396)
	pt3dadd(4.581, 30.44, 62.455, 0.50954)
	pt3dadd(4.581, 30.635, 62.165, 0.63382)
	pt3dadd(4.801, 30.953, 62.533, 0.54398)
	pt3dadd(4.857, 31.054, 62.524, 0.60198)
	pt3dadd(4.868, 31.305, 62.713, 0.66)
	pt3dadd(4.705, 31.609, 62.642, 0.48154)
	pt3dadd(4.649, 31.638, 62.654, 0.396)
	pt3dadd(4.649, 31.658, 62.709, 0.396)
	pt3dadd(4.584, 31.882, 63.45, 0.396)
  }
  dend[8] {pt3dclear()
	pt3dadd(4.291, 29.441, 61.964, 0.88874)
	pt3dadd(4.315, 29.33, 62.113, 0.7028)
	pt3dadd(4.195, 29.43, 62.355, 1.00958)
	pt3dadd(4.266, 29.479, 62.252, 1.31638)
	pt3dadd(4.43, 29.848, 62.267, 0.95052)
	pt3dadd(4.74, 29.928, 61.996, 0.8119)
	pt3dadd(5.07, 29.994, 62.396, 0.67326)
	pt3dadd(5.48, 30.251, 62.196, 0.53464)
	pt3dadd(5.675, 30.236, 62.731, 0.396)
	pt3dadd(5.693, 30.25, 62.832, 0.396)
  }
  dend[9] {pt3dclear()
	pt3dadd(6.06, 24.714, 61.596, 1.9401)
	pt3dadd(5.912, 24.376, 61.371, 2.0576)
	pt3dadd(5.695, 24.579, 61.516, 2.3414)
	pt3dadd(5.62, 24.563, 61.859, 2.254)
	pt3dadd(5.367, 24.84, 61.85, 1.92392)
	pt3dadd(5.316, 25.252, 62.052, 1.64578)
	pt3dadd(5.156, 25.551, 62.247, 1.68232)
	pt3dadd(4.614, 24.934, 61.831, 0.50198)
	pt3dadd(4.515, 24.895, 62.01, 0.64558)
	pt3dadd(4.278, 24.78, 61.996, 0.94458)
	pt3dadd(3.853, 24.479, 62.416, 1.24358)
	pt3dadd(3.741, 24.517, 62.123, 0.99084)
	pt3dadd(3.646, 24.487, 61.994, 0.93972)
  }
  dend[10] {pt3dclear()
	pt3dadd(3.646, 24.487, 61.994, 0.93972)
	pt3dadd(3.225, 24.515, 61.913, 0.396)
	pt3dadd(3.154, 24.478, 61.906, 0.38106)
	pt3dadd(3.058, 24.478, 61.961, 0.66)
	pt3dadd(2.959, 24.535, 62.246, 0.66)
	pt3dadd(2.902, 24.487, 62.271, 0.396)
	pt3dadd(2.854, 24.461, 62.227, 0.41162)
	pt3dadd(2.705, 24.416, 62.026, 0.66)
	pt3dadd(2.628, 24.497, 62.043, 0.55484)
	pt3dadd(2.557, 24.46, 62.019, 0.58548)
	pt3dadd(2.464, 24.419, 62.321, 0.51296)
	pt3dadd(2.233, 24.501, 62.381, 0.61316)
	pt3dadd(2.148, 24.485, 62.339, 0.38944)
	pt3dadd(2.097, 24.47, 62.193, 0.396)
	pt3dadd(2.057, 24.459, 62.041, 0.396)
	pt3dadd(1.902, 24.384, 61.934, 0.35112)
	pt3dadd(1.646, 24.427, 62.046, 0.30624)
	pt3dadd(1.583, 24.457, 62.045, 0.30166)
  }
}
proc shape3d_2() {
  dend[10] {	pt3dadd(1.567, 24.486, 62.103, 0.396)
	pt3dadd(1.177, 24.704, 62.061, 0.49656)
	pt3dadd(0.973, 24.868, 62.333, 0.65166)
	pt3dadd(0.897, 24.951, 62.364, 0.58768)
	pt3dadd(0.842, 24.967, 62.591, 0.66)
	pt3dadd(0.589, 25.072, 62.765, 0.396)
	pt3dadd(0.515, 25.073, 62.767, 0.5269)
	pt3dadd(0.48, 25.121, 62.8, 0.50804)
	pt3dadd(0.347, 25.268, 62.675, 0.54686)
	pt3dadd(0.242, 25.299, 62.726, 0.4428)
	pt3dadd(0.223, 25.411, 62.773, 0.396)
	pt3dadd(0.19, 25.502, 62.67, 0.396)
	pt3dadd(0.05, 25.638, 62.74, 0.396)
	pt3dadd(-0.012, 25.704, 62.789, 0.396)
	pt3dadd(-0.064, 25.725, 62.904, 0.39026)
	pt3dadd(-0.342, 26.1, 62.796, 0.37766)
	pt3dadd(-0.778, 26.272, 63.047, 0.36508)
	pt3dadd(-0.551, 26.595, 62.884, 0.35248)
	pt3dadd(-0.677, 26.837, 63.423, 0.52202)
  }
  dend[11] {pt3dclear()
	pt3dadd(-0.677, 26.837, 63.423, 0.52202)
	pt3dadd(0.057, 27.985, 64.03, 0.69156)
  }
  dend[12] {pt3dclear()
	pt3dadd(4.503, 28.822, 61.931, 0.55742)
	pt3dadd(4.357, 29.151, 61.779, 0.86112)
	pt3dadd(4.32, 29.425, 61.843, 0.81316)
	pt3dadd(4.226, 29.524, 62.456, 0.9576)
	pt3dadd(4.228, 29.488, 62.546, 1.02904)
	pt3dadd(3.869, 28.827, 62.675, 0.95128)
	pt3dadd(3.772, 28.742, 62.796, 0.87352)
	pt3dadd(4.76, 31.28, 62.475, 0.79576)
  }
  dend[13] {pt3dclear()
	pt3dadd(4.394, 29.906, 62.378, 0.9666)
	pt3dadd(4.41, 30.126, 62.396, 0.718)
	pt3dadd(4.403, 30.153, 62.295, 0.64024)
	pt3dadd(4.421, 29.948, 62.049, 0.90268)
	pt3dadd(4.314, 29.524, 62.277, 1.16512)
	pt3dadd(4.176, 29.512, 62.675, 0.92388)
	pt3dadd(4.061, 29.596, 62.93, 0.88048)
	pt3dadd(3.647, 29.564, 62.889, 0.31776)
	pt3dadd(3.425, 29.557, 62.911, 0.3965)
	pt3dadd(3.372, 29.554, 63.282, 0.27728)
  }
  dend[14] {pt3dclear()
	pt3dadd(7.017, 23.891, 57.976, 2.7314)
	pt3dadd(7.128, 23.781, 57.628, 2.6308)
	pt3dadd(7.142, 23.896, 57.601, 2.6448)
	pt3dadd(7.299, 24.001, 57.506, 2.6588)
	pt3dadd(7.466, 24.101, 57.46, 2.5482)
	pt3dadd(7.501, 24.195, 57.567, 2.5638)
	pt3dadd(7.69, 24.28, 57.622, 2.6324)
	pt3dadd(7.768, 24.571, 57.598, 2.6444)
	pt3dadd(7.959, 24.785, 57.584, 2.6564)
	pt3dadd(8.193, 24.874, 56.787, 2.6108)
	pt3dadd(8.215, 25.132, 56.774, 2.6328)
	pt3dadd(7.855, 25.388, 57.559, 2.5202)
	pt3dadd(7.974, 25.638, 57.596, 2.4578)
	pt3dadd(8.106, 25.902, 57.596, 2.3954)
	pt3dadd(8.477, 26.207, 57.717, 2.333)
	pt3dadd(8.551, 26.275, 57.821, 2.1768)
	pt3dadd(8.694, 26.477, 57.877, 1.95956)
	pt3dadd(8.791, 26.647, 58.242, 1.71346)
	pt3dadd(8.991, 26.705, 58.757, 1.72884)
	pt3dadd(9.447, 26.982, 58.821, 1.37924)
	pt3dadd(9.55, 27.06, 58.903, 1.19922)
	pt3dadd(9.748, 27.07, 59, 1.21376)
	pt3dadd(10.107, 27.16, 59.259, 0.84834)
	pt3dadd(10.17, 27.195, 59.392, 0.90634)
	pt3dadd(10.674, 27.028, 59.515, 0.93154)
	pt3dadd(10.836, 26.999, 59.564, 0.8684)
	pt3dadd(11.192, 26.897, 59.538, 0.96906)
	pt3dadd(11.446, 26.727, 59.581, 1.11254)
	pt3dadd(11.65, 26.633, 59.935, 1.09474)
	pt3dadd(11.873, 26.536, 60.43, 1.25518)
	pt3dadd(11.945, 26.533, 60.824, 1.32474)
	pt3dadd(12.003, 26.526, 61.226, 1.32334)
	pt3dadd(11.915, 26.733, 61.633, 1.3884)
	pt3dadd(12.085, 26.577, 62.015, 1.53778)
  }
  dend[15] {pt3dclear()
	pt3dadd(12.085, 26.577, 62.015, 1.53778)
	pt3dadd(12.062, 26.652, 62.424, 1.58468)
	pt3dadd(12.068, 26.659, 62.834, 1.63126)
	pt3dadd(12.152, 26.694, 63.231, 1.69988)
	pt3dadd(12.245, 26.675, 63.762, 1.55766)
	pt3dadd(12.316, 26.639, 63.835, 1.61094)
	pt3dadd(12.489, 26.738, 64.206, 1.47406)
	pt3dadd(12.635, 26.687, 64.315, 1.40002)
	pt3dadd(13.163, 26.69, 64.648, 1.1459)
	pt3dadd(13.321, 26.673, 64.743, 1.09564)
	pt3dadd(13.871, 26.672, 64.773, 0.396)
	pt3dadd(13.938, 26.681, 64.78, 0.52662)
	pt3dadd(13.985, 26.672, 64.831, 0.6909)
	pt3dadd(14.024, 26.692, 65.186, 0.396)
	pt3dadd(14.246, 26.638, 65.181, 0.37778)
	pt3dadd(14.441, 26.757, 65.383, 0.38092)
	pt3dadd(14.564, 26.795, 65.322, 0.49962)
	pt3dadd(14.627, 26.755, 65.204, 0.5834)
	pt3dadd(14.741, 26.777, 65.141, 0.47898)
	pt3dadd(14.812, 26.82, 65.119, 0.42446)
	pt3dadd(14.911, 26.784, 65.104, 0.50572)
  }
  dend[16] {pt3dclear()
	pt3dadd(14.911, 26.784, 65.104, 0.50572)
	pt3dadd(15.106, 26.785, 65.1, 0.53804)
	pt3dadd(15.17, 26.81, 65.085, 0.396)
	pt3dadd(15.297, 26.826, 65.215, 0.396)
	pt3dadd(15.495, 26.774, 65.244, 0.3997)
	pt3dadd(15.631, 26.826, 65.178, 0.396)
	pt3dadd(15.761, 26.859, 65.182, 0.52148)
	pt3dadd(15.828, 26.859, 65.178, 0.396)
	pt3dadd(15.893, 26.872, 65.192, 0.44964)
	pt3dadd(16.09, 26.885, 65.206, 0.4735)
	pt3dadd(16.368, 26.958, 65.144, 0.41432)
	pt3dadd(16.397, 26.934, 65.234, 0.35514)
	pt3dadd(16.761, 26.866, 65.546, 0.29596)
	pt3dadd(16.82, 26.88, 65.485, 0.396)
	pt3dadd(17.008, 26.818, 65.263, 0.37654)
	pt3dadd(17.401, 26.811, 65.192, 0.36256)
	pt3dadd(17.484, 26.839, 65.124, 0.3486)
	pt3dadd(17.549, 26.85, 64.967, 0.33462)
	pt3dadd(17.808, 26.694, 65.196, 0.32064)
	pt3dadd(18.072, 26.694, 65.196, 0.30668)
	pt3dadd(18.336, 26.826, 65.196, 0.2927)
	pt3dadd(18.568, 26.895, 64.84, 0.27872)
	pt3dadd(18.864, 26.955, 65.216, 0.45088)
	pt3dadd(19.225, 27.059, 65.173, 0.62306)
	pt3dadd(19.364, 27.096, 64.867, 0.55272)
	pt3dadd(19.419, 27.109, 64.738, 0.54932)
	pt3dadd(19.458, 27.13, 64.749, 0.51284)
  }
  dend[17] {pt3dclear()
	pt3dadd(-0.677, 26.837, 63.423, 0.52202)
	pt3dadd(-0.55, 26.482, 63.19, 0.47636)
  }
  dend[18] {pt3dclear()
	pt3dadd(-0.55, 26.482, 63.19, 0.47636)
	pt3dadd(-0.614, 26.424, 63.187, 0.396)
	pt3dadd(-0.963, 26.119, 63.097, 0.3362)
	pt3dadd(-1.001, 26.108, 63.187, 0.30336)
	pt3dadd(-0.966, 25.957, 63.561, 0.396)
	pt3dadd(-1.011, 25.847, 63.6, 0.31608)
	pt3dadd(-1.221, 25.725, 63.318, 0.31272)
	pt3dadd(-1.341, 25.663, 63.567, 0.30938)
  }
  dend[19] {pt3dclear()
	pt3dadd(-0.55, 26.482, 63.19, 0.47636)
	pt3dadd(-0.769, 26.891, 63.413, 0.66)
  }
  dend[20] {pt3dclear()
	pt3dadd(3.646, 24.487, 61.994, 0.93972)
	pt3dadd(3.684, 24.648, 61.996, 0.81806)
	pt3dadd(3.914, 24.624, 61.933, 0.97612)
	pt3dadd(3.876, 24.605, 62.097, 1.00826)
  }
  dend[21] {pt3dclear()
	pt3dadd(3.876, 24.605, 62.097, 1.00826)
	pt3dadd(4.066, 24.655, 62.53, 1.232)
	pt3dadd(4.299, 24.399, 63.274, 0.90544)
	pt3dadd(4.655, 24.293, 62.372, 0.396)
	pt3dadd(4.917, 24.083, 62.364, 0.48496)
	pt3dadd(5.202, 24.054, 62.796, 1.15364)
	pt3dadd(5.824, 24.508, 61.89, 1.82232)
	pt3dadd(6.012, 24.309, 61.959, 1.72228)
	pt3dadd(6.469, 23.97, 61.96, 1.89418)
	pt3dadd(6.634, 23.841, 62.379, 1.32208)
	pt3dadd(6.742, 23.772, 62.745, 1.23222)
	pt3dadd(6.258, 23.592, 63.596, 1.3561)
	pt3dadd(6.522, 23.658, 63.596, 1.48)
	pt3dadd(6.713, 23.78, 62.855, 1.60388)
	pt3dadd(7.196, 23.659, 62.785, 1.72776)
	pt3dadd(7.48, 23.378, 63.299, 1.68026)
	pt3dadd(7.583, 23.34, 63.352, 1.71728)
	pt3dadd(7.833, 23.351, 63.8, 1.75428)
	pt3dadd(7.974, 23.658, 64.796, 1.52922)
	pt3dadd(8.568, 23.368, 64.164, 1.30416)
	pt3dadd(8.854, 23.103, 64.292, 1.76882)
	pt3dadd(9.132, 23.422, 65.063, 1.26116)
	pt3dadd(9.429, 23.159, 65.133, 0.66)
	pt3dadd(9.647, 23.05, 65.192, 0.51386)
	pt3dadd(9.839, 22.571, 65.109, 0.39624)
	pt3dadd(9.604, 22.143, 65.037, 0.63824)
	pt3dadd(9.401, 21.954, 64.402, 0.55258)
	pt3dadd(9.274, 21.731, 65.513, 0.46692)
	pt3dadd(8.845, 21.729, 65.609, 0.99802)
	pt3dadd(8.766, 21.765, 65.357, 1.00612)
	pt3dadd(8.81, 21.761, 64.62, 1.17008)
	pt3dadd(9.123, 21.375, 65.076, 0.89706)
	pt3dadd(9.234, 21.119, 65.197, 0.62404)
	pt3dadd(9.417, 21.05, 65.205, 0.64998)
	pt3dadd(9.499, 20.968, 65.109, 0.56468)
	pt3dadd(9.599, 20.889, 65.188, 0.50374)
	pt3dadd(9.655, 20.871, 65.324, 0.43828)
	pt3dadd(9.946, 20.76, 65.299, 0.50656)
	pt3dadd(10.067, 20.706, 65.233, 0.45778)
	pt3dadd(10.106, 20.646, 65.251, 0.52818)
	pt3dadd(10.234, 20.534, 65.861, 0.50764)
	pt3dadd(10.335, 20.451, 65.7, 0.48712)
	pt3dadd(10.819, 20.171, 65.677, 0.57748)
	pt3dadd(10.876, 20.119, 65.516, 0.48676)
	pt3dadd(10.934, 20.103, 65.464, 0.50366)
	pt3dadd(11.041, 20.071, 65.442, 0.49858)
	pt3dadd(11.204, 20.049, 65.345, 0.59736)
	pt3dadd(11.292, 19.99, 65.234, 0.396)
	pt3dadd(11.385, 20.003, 65.278, 0.396)
	pt3dadd(11.469, 19.973, 65.435, 0.37096)
	pt3dadd(11.687, 19.944, 65.198, 0.39812)
	pt3dadd(11.818, 19.918, 65.188, 0.396)
	pt3dadd(12.008, 19.855, 65.404, 0.5221)
	pt3dadd(12.32, 19.641, 65.287, 0.5485)
	pt3dadd(12.363, 19.653, 65.348, 0.57492)
	pt3dadd(12.615, 19.411, 65.436, 0.60014)
  }
  dend[22] {pt3dclear()
	pt3dadd(14.911, 26.784, 65.104, 0.50572)
	pt3dadd(14.757, 26.744, 65.013, 0.57296)
	pt3dadd(14.55, 27.34, 65.212, 1.05362)
  }
  dend[23] {pt3dclear()
	pt3dadd(14.55, 27.34, 65.212, 1.05362)
	pt3dadd(14.349, 27.764, 65.206, 1.53426)
  }
  dend[24] {pt3dclear()
	pt3dadd(12.085, 26.577, 62.015, 1.53778)
	pt3dadd(12.092, 26.539, 62.286, 2.015)
  }
}
proc shape3d_3() {
  dend[24] {	pt3dadd(12.203, 26.376, 61.748, 1.7479)
	pt3dadd(12.565, 26.127, 61.698, 1.19378)
	pt3dadd(12.73, 26.014, 61.895, 0.91672)
	pt3dadd(12.803, 25.851, 61.884, 0.63964)
	pt3dadd(12.841, 25.834, 61.902, 0.66)
	pt3dadd(12.953, 25.824, 61.985, 0.66)
	pt3dadd(13.004, 25.717, 61.921, 0.63396)
	pt3dadd(13.078, 25.663, 62.006, 0.63354)
	pt3dadd(13.196, 25.581, 61.959, 0.57272)
	pt3dadd(13.239, 25.49, 62.083, 0.65502)
	pt3dadd(13.437, 25.29, 62.003, 0.61468)
	pt3dadd(13.521, 25.269, 62.032, 0.54948)
	pt3dadd(13.688, 25.179, 61.948, 0.50156)
	pt3dadd(14.062, 25.1, 62.301, 0.58078)
	pt3dadd(14.074, 25.093, 62.353, 0.66)
	pt3dadd(14.198, 25.1, 62.733, 0.73224)
	pt3dadd(14.272, 25.109, 63.092, 0.66)
	pt3dadd(14.281, 25.111, 63.129, 0.66)
	pt3dadd(14.295, 25.11, 63.163, 0.66)
	pt3dadd(14.475, 25.053, 63.221, 0.66)
	pt3dadd(14.51, 25.041, 63.277, 0.66)
	pt3dadd(14.687, 24.948, 63.545, 0.65908)
	pt3dadd(14.734, 24.961, 63.642, 0.53672)
	pt3dadd(15.13, 24.947, 63.941, 0.396)
	pt3dadd(15.168, 24.861, 64.032, 0.55264)
	pt3dadd(15.227, 24.729, 63.927, 0.66)
	pt3dadd(15.31, 24.672, 63.916, 0.67414)
	pt3dadd(15.363, 24.616, 63.973, 0.70698)
	pt3dadd(15.448, 24.592, 64.181, 0.75514)
	pt3dadd(15.531, 24.58, 64.322, 0.83534)
	pt3dadd(15.765, 24.471, 64.174, 0.79806)
	pt3dadd(15.828, 24.429, 64.135, 0.7737)
	pt3dadd(16.011, 24.356, 64.165, 0.88116)
	pt3dadd(16.044, 24.316, 64.22, 0.90588)
	pt3dadd(16.323, 24.245, 64.35, 0.83386)
	pt3dadd(16.355, 24.106, 64.295, 0.66)
	pt3dadd(16.614, 24.085, 64.333, 0.57188)
	pt3dadd(16.758, 24.031, 64.256, 0.59708)
	pt3dadd(16.822, 24.054, 63.965, 0.46226)
	pt3dadd(17.061, 23.965, 63.945, 0.47196)
  }
  dend[25] {pt3dclear()
	pt3dadd(17.061, 23.965, 63.945, 0.47196)
	pt3dadd(17.169, 23.988, 64.305, 0.64288)
	pt3dadd(17.16, 24.062, 64.56, 0.51976)
	pt3dadd(17.567, 23.768, 64.25, 0.39664)
	pt3dadd(17.626, 23.69, 64.322, 0.396)
	pt3dadd(18.109, 23.58, 64.328, 0.46668)
	pt3dadd(18.298, 23.523, 64.65, 0.52254)
	pt3dadd(18.366, 23.482, 64.729, 0.37806)
	pt3dadd(18.428, 23.405, 64.768, 0.22066)
	pt3dadd(18.719, 23.395, 64.658, 0.396)
	pt3dadd(19.005, 23.391, 64.726, 0.42712)
	pt3dadd(19.197, 23.401, 64.753, 0.45824)
	pt3dadd(19.236, 23.524, 64.741, 0.396)
	pt3dadd(19.524, 23.658, 64.396, 0.396)
	pt3dadd(19.788, 23.658, 64.396, 0.396)
	pt3dadd(20.071, 23.921, 64.416, 0.396)
	pt3dadd(20.187, 23.992, 64.411, 0.29204)
  }
  dend[26] {pt3dclear()
	pt3dadd(-0.55, 26.482, 63.19, 0.47636)
	pt3dadd(-0.589, 26.541, 63.089, 0.343)
	pt3dadd(-0.909, 26.981, 63.296, 0.39394)
  }
  dend[27] {pt3dclear()
	pt3dadd(3.876, 24.605, 62.097, 1.00826)
	pt3dadd(3.905, 24.539, 62.018, 1.02662)
	pt3dadd(3.948, 24.615, 62.729, 1.10118)
  }
  dend[28] {pt3dclear()
	pt3dadd(14.55, 27.34, 65.212, 1.05362)
	pt3dadd(14.794, 27.08, 65.196, 0.92438)
	pt3dadd(14.421, 26.717, 65.455, 0.74758)
  }
  dend[29] {pt3dclear()
	pt3dadd(17.061, 23.965, 63.945, 0.47196)
	pt3dadd(16.954, 23.998, 63.98, 0.48052)
  }
  dend[30] {pt3dclear()
	pt3dadd(16.954, 23.998, 63.98, 0.48052)
	pt3dadd(17.049, 24.125, 64.786, 0.27254)
	pt3dadd(17.054, 24.143, 64.811, 0.33428)
	pt3dadd(17.157, 24.395, 64.711, 0.396)
	pt3dadd(17.242, 24.484, 64.694, 0.61982)
	pt3dadd(17.339, 24.614, 64.689, 0.41362)
	pt3dadd(17.362, 24.664, 64.756, 0.39232)
	pt3dadd(17.609, 25.117, 64.533, 0.4985)
	pt3dadd(17.648, 25.324, 64.774, 0.44024)
	pt3dadd(17.688, 25.347, 64.816, 0.53756)
	pt3dadd(17.726, 25.387, 65.125, 0.4649)
	pt3dadd(17.845, 25.46, 65.604, 0.4531)
	pt3dadd(17.889, 25.496, 65.672, 0.44066)
	pt3dadd(18.262, 25.773, 65.411, 0.63992)
	pt3dadd(18.333, 25.847, 65.561, 0.61448)
	pt3dadd(18.412, 26.03, 65.891, 0.60418)
	pt3dadd(18.451, 26.058, 65.93, 0.5229)
	pt3dadd(18.447, 26.073, 66.032, 0.52136)
  }
  dend[31] {pt3dclear()
	pt3dadd(16.954, 23.998, 63.98, 0.48052)
	pt3dadd(16.927, 23.983, 63.924, 0.396)
  }
}
proc basic_shape() {
  shape3d_1()
  shape3d_2()
  shape3d_3()
}

objref all, dendritic
proc subsets() { local i
  objref all, dendritic
  all = new SectionList()
    for i=0, 31 dend[i] all.append()

  dendritic = new SectionList()
    for i=0, 31 dend[i] dendritic.append()
}

proc geom_nseg() {
  forsec all {nseg = int((L/(0.1*lambda_f(100))+.999)/2)*2 + 1 }
}

func lambda_f() {local i, x1, x2, d1, d2, lam, axialR, capacitance
        axialR = 132
        capacitance = 1.18

        if (n3d() < 2) {
                return 1e-5*sqrt(diam/(4*PI*$1*axialR*capacitance))
        }

        x1 = arc3d(0)
        d1 = diam3d(0)
        lam = 0
        for i=1, n3d()-1 {
                x2 = arc3d(i)
                d2 = diam3d(i)
                lam += (x2 - x1)/sqrt(d1 + d2)
                x1 = x2   d1 = d2
        }
        //  length of the section in units of lambda
        lam *= sqrt(2) * 1e-5*sqrt(4*PI*$1*axialR*capacitance)

        return L/lam
}

access dend

celldef()
